# .Rprofile template that we may use for each module during the
# installation.
Sys.setenv(GITHUB_PAT="@GITHUB_PAT@")
Sys.setenv(RENV_PATHS_ROOT="@MODULES_RENV_ROOT_PATH@")
Sys.setenv(RENV_PATHS_CACHE="@MODULES_RENV_CACHE_PATH@")
Sys.setenv(JASPENGINE_LOCATION="@JASP_ENGINE_PATH@/JASPEngine")
Sys.setenv(JAGS_PREFIX="@jags_BUILD_DIR@")
Sys.setenv(JAGS_INCLUDEDIR="@jags_INCLUDE_DIRS@")
Sys.setenv(JAGS_LIBDIR="@jags_LIBRARY_DIRS@")
Sys.setenv(PKG_CONFIG_PATH="@jags_PKG_CONFIG_PATH@")

options(pkgType = "binary")
result <- jaspBase::installJaspModule("@MODULES_SOURCE_PATH@/@MODULE@", 
	libPathsToUse=NULL, 
	repos="@R_REPOSITORY@", 
	moduleLibrary="@MODULES_BINARY_PATH@/@MODULE@", 
	onlyModPkg=FALSE)
	
print(result)

if (result == "succes") {
	cat(NULL, file="@MODULES_RENV_ROOT_PATH@/@MODULE@-installed-successfully.log")
}

# Fixing the renv's symlinks
source('@MODULES_BINARY_PATH@/symlinkTools.R')

convertAbsoluteSymlinksToRelative('@MODULES_BINARY_PATH@', '@MODULES_RENV_CACHE_PATH@')